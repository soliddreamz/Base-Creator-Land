<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Base Fan App</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#0b0b0f;
  color:white;
}
header{
  padding:16px;
  border-bottom:1px solid #222;
}
section{padding:16px}
.badge{padding:6px 10px;border-radius:20px;background:#222;font-size:12px}
</style>
</head>

<body>
<header>
  <h2 id="name">Creator Name</h2>
  <div class="badge" id="live">OFFLINE</div>
</header>

<section>
  <p id="bio">Bio goes here</p>
</section>

<script>
/*
  Base Fan App â€” V1 (Static Hosting Correct)
  Source of truth: ./content.json
  Update method: pull + apply
*/

const CONTENT_URL = "./content.json";
const POLL_INTERVAL = 15000; // 15s

function applyState(d){
  if (!d) return;

  document.getElementById("name").textContent = d.name || "";
  document.getElementById("bio").textContent  = d.bio || "";
  document.getElementById("live").textContent = d.live ? "LIVE" : "OFFLINE";
}

async function fetchState(){
  const url = new URL(CONTENT_URL, location.href);
  url.searchParams.set("ts", Date.now()); // cache bust

  const res = await fetch(url.toString(), { cache:"no-store" });
  if (!res.ok) throw new Error("Failed to load content.json");
  return res.json();
}

async function tick(){
  try{
    const state = await fetchState();
    applyState(state);
  }catch(e){
    // silent fail (V1)
  }
}

// initial load
tick();

// poll
setInterval(tick, POLL_INTERVAL);

// refresh on tab focus
document.addEventListener("visibilitychange", () => {
  if (!document.hidden) tick();
});
</script>
</body>
</html>
